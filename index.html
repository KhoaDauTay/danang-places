<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food & Dating Places - Kh√°m ph√° th√†nh ph·ªë c·ªßa t√¥i</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-links a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .nav-links a:hover, .nav-links a.active {
            color: #667eea;
            transform: translateY(-2px);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 100px 2rem 2rem;
            min-height: 100vh;
        }

        .page {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Home Page Styles */
        .hero {
            text-align: center;
            padding: 4rem 0;
            color: white;
        }

        .hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .hero p {
            font-size: 1.3rem;
            margin-bottom: 2rem;
            opacity: 0.9;
        }

        .hero-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
            margin: 3rem 0;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.15);
            padding: 2rem;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 1rem;
            opacity: 0.8;
        }

        .featured-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 3rem;
            margin: 3rem 0;
            backdrop-filter: blur(10px);
        }

        .featured-section h2 {
            color: #333;
            margin-bottom: 2rem;
            font-size: 2rem;
        }

        .featured-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .featured-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .featured-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }

        .featured-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 1rem;
        }

        .featured-card h3 {
            margin-bottom: 0.5rem;
            color: #333;
        }

        .featured-card p {
            color: #666;
            font-size: 0.9rem;
        }

        /* Places Page Styles */
        .page-header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            backdrop-filter: blur(10px);
        }

        .page-header h1 {
            color: #333;
            margin-bottom: 1rem;
            font-size: 2.5rem;
        }

        .controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            padding: 12px 20px;
            border: 2px solid #e1e5e9;
            border-radius: 25px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .search-box:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            white-space: nowrap;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-outline {
            background: transparent;
            border: 2px solid #667eea;
            color: #667eea;
        }

        .btn-outline:hover {
            background: #667eea;
            color: white;
        }

        .filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 2px solid #e1e5e9;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .filter-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .view-toggle {
            display: flex;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .view-btn {
            padding: 10px 15px;
            border: none;
            background: transparent;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .view-btn.active {
            background: #667eea;
            color: white;
        }

        .places-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 2rem;
        }

        .places-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .place-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .place-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }

        .place-card.list-view {
            display: flex;
            gap: 1.5rem;
            align-items: center;
        }

        .place-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 1rem;
        }

        .list-view .place-image {
            width: 150px;
            height: 100px;
            margin-bottom: 0;
        }

        .place-info h3 {
            margin-bottom: 0.5rem;
            color: #333;
            font-size: 1.3rem;
        }

        .place-meta {
            display: flex;
            gap: 1rem;
            margin: 0.5rem 0;
            flex-wrap: wrap;
        }

        .place-tag {
            background: #f1f3f4;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            color: #666;
        }

        .place-status {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .status-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 15px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .status-btn.visited {
            background: #28a745;
            color: white;
        }

        .status-btn.wishlist {
            background: #ffc107;
            color: #333;
        }

        .status-btn.favorite {
            background: #dc3545;
            color: white;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            padding: 2rem;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: #666;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #333;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .file-upload {
            border: 2px dashed #e1e5e9;
            border-radius: 10px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-upload:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.05);
        }

        .file-upload input {
            display: none;
        }

        .image-preview {
            max-width: 100%;
            max-height: 200px;
            border-radius: 10px;
            margin-top: 1rem;
        }

        /* Menu Styles */
        .menu-section {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 2px solid #f1f3f4;
        }

        .menu-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 1rem;
        }

        .menu-item-info h4 {
            margin-bottom: 0.5rem;
            color: #333;
        }

        .menu-item-info p {
            color: #666;
            font-size: 0.9rem;
        }

        .menu-price {
            font-weight: bold;
            color: #667eea;
            font-size: 1.1rem;
        }

        .csv-import {
            margin-top: 1rem;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 10px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-container {
                flex-direction: column;
                gap: 1rem;
            }

            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
            }

            .hero h1 {
                font-size: 2.5rem;
            }

            .hero-stats {
                grid-template-columns: 1fr 1fr;
            }

            .controls {
                flex-direction: column;
                align-items: stretch;
            }

            .search-box {
                min-width: auto;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .places-grid {
                grid-template-columns: 1fr;
            }

            .place-card.list-view {
                flex-direction: column;
                text-align: center;
            }

            .list-view .place-image {
                width: 100%;
                height: 200px;
            }

            .modal {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
<!-- Navigation -->
<nav class="navbar">
    <div class="nav-container">
        <div class="logo">üçΩÔ∏è Food Places</div>
        <ul class="nav-links">
            <li><a href="#" onclick="showPage('home')" class="active">Trang ch·ªß</a></li>
            <li><a href="#" onclick="showPage('places')">ƒê·ªãa ƒëi·ªÉm</a></li>
            <li><a href="#" onclick="showPage('favorites')">Y√™u th√≠ch</a></li>
            <li><a href="#" onclick="showPage('add-place')">Th√™m m·ªõi</a></li>
        </ul>
    </div>
</nav>

<div class="container">
    <!-- Home Page -->
    <div id="home" class="page active">
        <div class="hero">
            <h1>Kh√°m ph√° th√†nh ph·ªë qua ·∫©m th·ª±c</h1>
            <p>L∆∞u tr·ªØ v√† chia s·∫ª nh·ªØng ƒë·ªãa ƒëi·ªÉm ƒÉn u·ªëng, h·∫πn h√≤ tuy·ªát v·ªùi nh·∫•t</p>

            <div class="hero-stats">
                <div class="stat-card">
                    <div class="stat-number" id="totalPlaces">0</div>
                    <div class="stat-label">ƒê·ªãa ƒëi·ªÉm</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalDishes">0</div>
                    <div class="stat-label">M√≥n ƒÉn</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="visitedPlaces">0</div>
                    <div class="stat-label">ƒê√£ gh√© thƒÉm</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="favoriteCount">0</div>
                    <div class="stat-label">Y√™u th√≠ch</div>
                </div>
            </div>
        </div>

        <div class="featured-section">
            <h2>üî• ƒê·ªãa ƒëi·ªÉm n·ªïi b·∫≠t</h2>
            <div class="featured-grid" id="featuredPlaces">
                <!-- Featured places will be populated here -->
            </div>
        </div>

        <div class="featured-section">
            <h2>üç¥ M√≥n ƒÉn ƒë√°ng th·ª≠</h2>
            <div class="featured-grid" id="featuredDishes">
                <!-- Featured dishes will be populated here -->
            </div>
        </div>
    </div>

    <!-- Places Page -->
    <div id="places" class="page">
        <div class="page-header">
            <h1>üìç Danh s√°ch ƒë·ªãa ƒëi·ªÉm</h1>
            <p>T·∫•t c·∫£ c√°c ƒë·ªãa ƒëi·ªÉm ƒÉn u·ªëng v√† h·∫πn h√≤ ƒë∆∞·ª£c l∆∞u tr·ªØ</p>
        </div>

        <div class="controls">
            <input type="text" class="search-box" id="searchBox" placeholder="üîç T√¨m ki·∫øm ƒë·ªãa ƒëi·ªÉm...">
            <div class="view-toggle">
                <button class="view-btn active" onclick="setView('grid')">‚äû L∆∞·ªõi</button>
                <button class="view-btn" onclick="setView('list')">‚ò∞ Danh s√°ch</button>
            </div>
            <button class="btn btn-primary" onclick="showModal('addPlaceModal')">‚ûï Th√™m ƒë·ªãa ƒëi·ªÉm</button>
        </div>

        <div class="filters" id="categoryFilters">
            <!-- Category filters will be populated here -->
        </div>

        <div id="placesContainer" class="places-grid">
            <!-- Places will be populated here -->
        </div>
    </div>

    <!-- Favorites Page -->
    <div id="favorites" class="page">
        <div class="page-header">
            <h1>‚ù§Ô∏è ƒê·ªãa ƒëi·ªÉm y√™u th√≠ch</h1>
            <p>Nh·ªØng n∆°i b·∫°n ƒë√°nh d·∫•u l√† y√™u th√≠ch</p>
        </div>

        <div id="favoritesContainer" class="places-grid">
            <!-- Favorite places will be populated here -->
        </div>
    </div>

    <!-- Add Place Page -->
    <div id="add-place" class="page">
        <div class="page-header">
            <h1>‚ûï Th√™m ƒë·ªãa ƒëi·ªÉm m·ªõi</h1>
            <p>Chia s·∫ª nh·ªØng kh√°m ph√° m·ªõi c·ªßa b·∫°n</p>
        </div>

        <div style="background: white; border-radius: 20px; padding: 2rem;">
            <form id="addPlaceForm" onsubmit="addPlace(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label>T√™n ƒë·ªãa ƒëi·ªÉm *</label>
                        <input type="text" name="name" required>
                    </div>
                    <div class="form-group">
                        <label>Lo·∫°i h√¨nh</label>
                        <select name="category" required>
                            <option value="Nh√† h√†ng">üçΩÔ∏è Nh√† h√†ng</option>
                            <option value="Qu√°n cafe">‚òï Qu√°n cafe</option>
                            <option value="Bar">üç∫ Bar</option>
                            <option value="ƒÇn v·∫∑t">üçø ƒÇn v·∫∑t</option>
                            <option value="Buffet">üç¥ Buffet</option>
                            <option value="Fast food">üçî Fast food</option>
                            <option value="Dessert">üç∞ Dessert</option>
                            <option value="Gi·∫£i tr√≠">üéÆ Gi·∫£i tr√≠</option>
                            <option value="Kh√°c">üìç Kh√°c</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>ƒê·ªãa ch·ªâ *</label>
                    <input type="text" name="address" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>S·ªë ƒëi·ªán tho·∫°i</label>
                        <input type="tel" name="phone">
                    </div>
                    <div class="form-group">
                        <label>Link ƒë·∫∑t b√†n</label>
                        <input type="url" name="bookingLink" placeholder="https://...">
                    </div>
                </div>

                <div class="form-group">
                    <label>H√¨nh ·∫£nh</label>
                    <div class="file-upload" onclick="document.getElementById('placeImage').click()">
                        <input type="file" id="placeImage" name="image" accept="image/*" onchange="previewImage(this, 'imagePreview')">
                        <div>üì∑ Ch·ªçn h√¨nh ·∫£nh</div>
                        <img id="imagePreview" class="image-preview" style="display: none;">
                    </div>
                </div>

                <div class="form-group">
                    <label>Ghi ch√∫ c√° nh√¢n</label>
                    <textarea name="notes" rows="4" placeholder="Chia s·∫ª c·∫£m nh·∫≠n, tr·∫£i nghi·ªám c·ªßa b·∫°n..."></textarea>
                </div>

                <div class="menu-section">
                    <h3>üçΩÔ∏è Th·ª±c ƒë∆°n</h3>
                    <div id="menuItems"></div>
                    <button type="button" class="btn btn-outline" onclick="addMenuItem()">‚ûï Th√™m m√≥n</button>

                    <div class="csv-import">
                        <h4>üìÑ Import t·ª´ file CSV</h4>
                        <p>File CSV c·∫ßn c√≥ c√°c c·ªôt: T√™n m√≥n, Gi√°, M√¥ t·∫£</p>
                        <input type="file" id="csvFile" accept=".csv" onchange="importCSV(this)">
                    </div>
                </div>

                <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                    <button type="submit" class="btn btn-primary">üíæ L∆∞u ƒë·ªãa ƒëi·ªÉm</button>
                    <button type="reset" class="btn btn-secondary">üîÑ L√†m m·ªõi</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Place Detail Modal -->
<div id="placeDetailModal" class="modal">
    <div class="modal-content">
        <button class="modal-close" onclick="hideModal('placeDetailModal')">&times;</button>
        <div id="placeDetailContent">
            <!-- Place detail content will be populated here -->
        </div>
    </div>
</div>

<!-- Add Place Modal -->
<div id="addPlaceModal" class="modal">
    <div class="modal-content">
        <button class="modal-close" onclick="hideModal('addPlaceModal')">&times;</button>
        <h2>‚ûï Th√™m ƒë·ªãa ƒëi·ªÉm nhanh</h2>
        <form id="quickAddForm" onsubmit="quickAddPlace(event)">
            <div class="form-group">
                <label>T√™n ƒë·ªãa ƒëi·ªÉm</label>
                <input type="text" name="name" required>
            </div>
            <div class="form-group">
                <label>Lo·∫°i h√¨nh</label>
                <select name="category" required>
                    <option value="Nh√† h√†ng">üçΩÔ∏è Nh√† h√†ng</option>
                    <option value="Qu√°n cafe">‚òï Qu√°n cafe</option>
                    <option value="Bar">üç∫ Bar</option>
                    <option value="ƒÇn v·∫∑t">üçø ƒÇn v·∫∑t</option>
                    <option value="Gi·∫£i tr√≠">üéÆ Gi·∫£i tr√≠</option>
                </select>
            </div>
            <div class="form-group">
                <label>ƒê·ªãa ch·ªâ</label>
                <input type="text" name="address" required>
            </div>
            <div class="form-group">
                <label>Ghi ch√∫</label>
                <textarea name="notes" rows="3"></textarea>
            </div>
            <div style="display: flex; gap: 1rem;">
                <button type="submit" class="btn btn-primary">üíæ L∆∞u</button>
                <button type="button" class="btn btn-secondary" onclick="hideModal('addPlaceModal')">H·ªßy</button>
            </div>
        </form>
    </div>
</div>

<script>
    // Data storage
    let places = JSON.parse(localStorage.getItem('places') || '[]');
    let currentView = 'grid';
    let currentFilter = 'all';

    // Initialize app
    document.addEventListener('DOMContentLoaded', function() {
        updateStats();
        updateFeaturedContent();
        displayPlaces();
        updateCategoryFilters();

        // Search functionality
        document.getElementById('searchBox').addEventListener('input', displayPlaces);
    });

    // Navigation functions
    function showPage(pageId) {
        // Hide all pages
        document.querySelectorAll('.page').forEach(page => {
            page.classList.remove('active');
        });

        // Show selected page
        document.getElementById(pageId).classList.add('active');

        // Update navigation
        document.querySelectorAll('.nav-links a').forEach(link => {
            link.classList.remove('active');
        });
        event.target.classList.add('active');

        // Update content based on page
        if (pageId === 'places') {
            displayPlaces();
        } else if (pageId === 'favorites') {
            displayFavorites();
        } else if (pageId === 'home') {
            updateStats();
            updateFeaturedContent();
        }
    }

    // Modal functions
    function showModal(modalId) {
        document.getElementById(modalId).classList.add('active');
    }

    function hideModal(modalId) {
        document.getElementById(modalId).classList.remove('active');
    }

    // Place management functions
    function addPlace(event) {
        event.preventDefault();
        const formData = new FormData(event.target);

        const place = {
            id: Date.now(),
            name: formData.get('name'),
            category: formData.get('category'),
            address: formData.get('address'),
            phone: formData.get('phone') || '',
            bookingLink: formData.get('bookingLink') || '',
            notes: formData.get('notes') || '',
            image: formData.get('image') ? URL.createObjectURL(formData.get('image')) : '',
            menu: currentMenu,
            dateAdded: new Date().toLocaleDateString('vi-VN'),
            status: 'wishlist',
            favorite: false
        };

        places.push(place);
        localStorage.setItem('places', JSON.stringify(places));

        // Reset form and menu
        event.target.reset();
        currentMenu = [];
        document.getElementById('menuItems').innerHTML = '';
        document.getElementById('imagePreview').style.display = 'none';

        updateStats();
        updateFeaturedContent();
        displayPlaces();
        updateCategoryFilters();

        alert('ƒê√£ th√™m ƒë·ªãa ƒëi·ªÉm th√†nh c√¥ng!');
    }

    function quickAddPlace(event) {
        event.preventDefault();
        const formData = new FormData(event.target);

        const place = {
            id: Date.now(),
            name: formData.get('name'),
            category: formData.get('category'),
            address: formData.get('address'),
            phone: '',
            bookingLink: '',
            notes: formData.get('notes') || '',
            image: '',
            menu: [],
            dateAdded: new Date().toLocaleDateString('vi-VN'),
            status: 'wishlist',
            favorite: false
        };

        places.push(place);
        localStorage.setItem('places', JSON.stringify(places));

        hideModal('addPlaceModal');
        event.target.reset();

        updateStats();
        updateFeaturedContent();
        displayPlaces();
        updateCategoryFilters();

        alert('ƒê√£ th√™m ƒë·ªãa ƒëi·ªÉm th√†nh c√¥ng!');
    }

    function deletePlace(id) {
        if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a ƒë·ªãa ƒëi·ªÉm n√†y?')) {
            places = places.filter(place => place.id !== id);
            localStorage.setItem('places', JSON.stringify(places));

            updateStats();
            updateFeaturedContent();
            displayPlaces();
            updateCategoryFilters();
        }
    }

    function toggleStatus(id, status) {
        const place = places.find(p => p.id === id);
        if (place) {
            place.status = place.status === status ? 'wishlist' : status;
            localStorage.setItem('places', JSON.stringify(places));
            updateStats();
            displayPlaces();
        }
    }

    function toggleFavorite(id) {
        const place = places.find(p => p.id === id);
        if (place) {
            place.favorite = !place.favorite;
            localStorage.setItem('places', JSON.stringify(places));
            updateStats();
            displayPlaces();
            displayFavorites();
        }
    }

    // Display functions
    function displayPlaces() {
        const container = document.getElementById('placesContainer');
        const searchTerm = document.getElementById('searchBox').value.toLowerCase();

        let filteredPlaces = places.filter(place => {
            const matchesSearch = place.name.toLowerCase().includes(searchTerm) ||
                place.address.toLowerCase().includes(searchTerm) ||
                place.category.toLowerCase().includes(searchTerm);
            const matchesFilter = currentFilter === 'all' || place.category === currentFilter;
            return matchesSearch && matchesFilter;
        });

        container.className = currentView === 'grid' ? 'places-grid' : 'places-list';
        container.innerHTML = '';

        if (filteredPlaces.length === 0) {
            container.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 3rem; color: #666;">
                        <h3>Kh√¥ng t√¨m th·∫•y ƒë·ªãa ƒëi·ªÉm n√†o</h3>
                        <p>Th·ª≠ thay ƒë·ªïi t·ª´ kh√≥a t√¨m ki·∫øm ho·∫∑c b·ªô l·ªçc</p>
                    </div>
                `;
            return;
        }

        filteredPlaces.forEach(place => {
            const card = createPlaceCard(place);
            container.appendChild(card);
        });
    }

    function createPlaceCard(place) {
        const card = document.createElement('div');
        card.className = `place-card ${currentView === 'list' ? 'list-view' : ''}`;

        const statusIcon = place.status === 'visited' ? '‚úÖ' : 'üìù';
        const favoriteIcon = place.favorite ? '‚ù§Ô∏è' : 'ü§ç';

        card.innerHTML = `
                ${place.image ? `<img src="${place.image}" alt="${place.name}" class="place-image">` : ''}
                <div class="place-info">
                    <h3>${place.name}</h3>
                    <div class="place-meta">
                        <span class="place-tag">${place.category}</span>
                        <span class="place-tag">üìç ${place.address}</span>
                        ${place.phone ? `<span class="place-tag">üìû ${place.phone}</span>` : ''}
                    </div>
                    ${place.notes ? `<p style="color: #666; margin: 0.5rem 0;">${place.notes}</p>` : ''}
                    <div class="place-status">
                        <button class="status-btn ${place.status === 'visited' ? 'visited' : ''}"
                                onclick="toggleStatus(${place.id}, 'visited')">
                            ${place.status === 'visited' ? '‚úÖ ƒê√£ ƒë·∫øn' : 'üìù Mu·ªën th·ª≠'}
                        </button>
                        <button class="status-btn ${place.favorite ? 'favorite' : ''}"
                                onclick="toggleFavorite(${place.id})">
                            ${place.favorite ? '‚ù§Ô∏è Y√™u th√≠ch' : 'ü§ç Y√™u th√≠ch'}
                        </button>
                        <button class="btn btn-outline" onclick="showPlaceDetail(${place.id})" style="padding: 6px 12px; font-size: 0.8rem;">
                            üëÅÔ∏è Chi ti·∫øt
                        </button>
                        <button class="btn btn-secondary" onclick="deletePlace(${place.id})" style="padding: 6px 12px; font-size: 0.8rem;">
                            üóëÔ∏è X√≥a
                        </button>
                    </div>
                </div>
            `;

        return card;
    }

    function displayFavorites() {
        const container = document.getElementById('favoritesContainer');
        const favoriteePlaces = places.filter(place => place.favorite);

        container.innerHTML = '';

        if (favoriteePlaces.length === 0) {
            container.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 3rem; color: #666;">
                        <h3>Ch∆∞a c√≥ ƒë·ªãa ƒëi·ªÉm y√™u th√≠ch</h3>
                        <p>H√£y ƒë√°nh d·∫•u ‚ù§Ô∏è nh·ªØng ƒë·ªãa ƒëi·ªÉm b·∫°n th√≠ch nh·∫•t</p>
                    </div>
                `;
            return;
        }

        favoriteePlaces.forEach(place => {
            const card = createPlaceCard(place);
            container.appendChild(card);
        });
    }

    function showPlaceDetail(id) {
        const place = places.find(p => p.id === id);
        if (!place) return;

        const content = document.getElementById('placeDetailContent');
        content.innerHTML = `
                <div style="text-align: center; margin-bottom: 2rem;">
                    ${place.image ? `<img src="${place.image}" alt="${place.name}" style="max-width: 100%; max-height: 300px; border-radius: 15px; margin-bottom: 1rem;">` : ''}
                    <h2>${place.name}</h2>
                    <p style="color: #666; font-size: 1.1rem;">${place.category} ‚Ä¢ ${place.address}</p>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                    ${place.phone ? `<div><strong>üìû ƒêi·ªán tho·∫°i:</strong><br>${place.phone}</div>` : ''}
                    ${place.bookingLink ? `<div><strong>üîó ƒê·∫∑t b√†n:</strong><br><a href="${place.bookingLink}" target="_blank">ƒê·∫∑t ngay</a></div>` : ''}
                    <div><strong>üìÖ Ng√†y th√™m:</strong><br>${place.dateAdded}</div>
                    <div><strong>üìä Tr·∫°ng th√°i:</strong><br>${place.status === 'visited' ? '‚úÖ ƒê√£ ƒë·∫øn' : 'üìù Mu·ªën th·ª≠'}</div>
                </div>

                ${place.notes ? `
                    <div style="margin-bottom: 2rem;">
                        <h3>üìù Ghi ch√∫</h3>
                        <p style="background: #f8f9fa; padding: 1rem; border-radius: 10px;">${place.notes}</p>
                    </div>
                ` : ''}

                ${place.menu && place.menu.length > 0 ? `
                    <div class="menu-section">
                        <h3>üçΩÔ∏è Th·ª±c ƒë∆°n (${place.menu.length} m√≥n)</h3>
                        ${place.menu.map(item => `
                            <div class="menu-item">
                                <div class="menu-item-info">
                                    <h4>${item.name}</h4>
                                    ${item.description ? `<p>${item.description}</p>` : ''}
                                </div>
                                <div class="menu-price">${item.price ? item.price.toLocaleString() + ' VNƒê' : 'Ch∆∞a c√≥ gi√°'}</div>
                            </div>
                        `).join('')}
                    </div>
                ` : ''}
            `;

        showModal('placeDetailModal');
    }

    // Menu management
    let currentMenu = [];

    function addMenuItem() {
        const menuContainer = document.getElementById('menuItems');
        const itemId = Date.now();

        const menuItem = document.createElement('div');
        menuItem.className = 'menu-item';
        menuItem.innerHTML = `
                <div style="flex: 1; display: grid; grid-template-columns: 2fr 1fr 2fr auto; gap: 1rem; align-items: center;">
                    <input type="text" placeholder="T√™n m√≥n" onchange="updateMenuItem(${itemId}, 'name', this.value)">
                    <input type="number" placeholder="Gi√°" onchange="updateMenuItem(${itemId}, 'price', this.value)">
                    <input type="text" placeholder="M√¥ t·∫£" onchange="updateMenuItem(${itemId}, 'description', this.value)">
                    <button type="button" onclick="removeMenuItem(${itemId})" style="background: #dc3545; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer;">üóëÔ∏è</button>
                </div>
            `;

        menuContainer.appendChild(menuItem);

        currentMenu.push({
            id: itemId,
            name: '',
            price: 0,
            description: ''
        });
    }

    function updateMenuItem(id, field, value) {
        const item = currentMenu.find(m => m.id === id);
        if (item) {
            item[field] = field === 'price' ? parseInt(value) || 0 : value;
        }
    }

    function removeMenuItem(id) {
        currentMenu = currentMenu.filter(m => m.id !== id);
        document.querySelector(`[onclick*="${id}"]`).closest('.menu-item').remove();
    }

    // CSV Import
    function importCSV(input) {
        const file = input.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(e) {
            const csv = e.target.result;
            const lines = csv.split('\n');
            const headers = lines[0].split(',').map(h => h.trim().toLowerCase());

            for (let i = 1; i < lines.length; i++) {
                const data = lines[i].split(',');
                if (data.length >= 2) {
                    addMenuItem();
                    const lastItem = currentMenu[currentMenu.length - 1];
                    lastItem.name = data[0]?.trim() || '';
                    lastItem.price = parseInt(data[1]?.trim()) || 0;
                    lastItem.description = data[2]?.trim() || '';

                    // Update the UI
                    const menuItems = document.querySelectorAll('#menuItems .menu-item');
                    const lastMenuItem = menuItems[menuItems.length - 1];
                    const inputs = lastMenuItem.querySelectorAll('input');
                    inputs[0].value = lastItem.name;
                    inputs[1].value = lastItem.price;
                    inputs[2].value = lastItem.description;
                }
            }

            alert(`ƒê√£ import ${currentMenu.length} m√≥n t·ª´ file CSV!`);
        };
        reader.readAsText(file);
    }

    // Utility functions
    function setView(view) {
        currentView = view;
        document.querySelectorAll('.view-btn').forEach(btn => btn.classList.remove('active'));
        event.target.classList.add('active');
        displayPlaces();
    }

    function setFilter(category) {
        currentFilter = category;
        document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
        event.target.classList.add('active');
        displayPlaces();
    }

    function updateCategoryFilters() {
        const container = document.getElementById('categoryFilters');
        const categories = ['all', ...new Set(places.map(p => p.category))];

        container.innerHTML = '';
        categories.forEach(category => {
            const btn = document.createElement('button');
            btn.className = `filter-btn ${currentFilter === category ? 'active' : ''}`;
            btn.textContent = category === 'all' ? 'T·∫•t c·∫£' : category;
            btn.onclick = () => setFilter(category);
            container.appendChild(btn);
        });
    }

    function updateStats() {
        document.getElementById('totalPlaces').textContent = places.length;
        document.getElementById('totalDishes').textContent = places.reduce((sum, place) => sum + (place.menu?.length || 0), 0);
        document.getElementById('visitedPlaces').textContent = places.filter(p => p.status === 'visited').length;
        document.getElementById('favoriteCount').textContent = places.filter(p => p.favorite).length;
    }

    function updateFeaturedContent() {
        // Featured places
        const featuredPlaces = places.filter(p => p.favorite || p.status === 'visited').slice(0, 6);
        const featuredPlacesContainer = document.getElementById('featuredPlaces');
        featuredPlacesContainer.innerHTML = '';

        if (featuredPlaces.length === 0) {
            featuredPlacesContainer.innerHTML = '<p style="text-align: center; color: #666; grid-column: 1/-1;">Ch∆∞a c√≥ ƒë·ªãa ƒëi·ªÉm n·ªïi b·∫≠t. H√£y th√™m v√† ƒë√°nh d·∫•u y√™u th√≠ch!</p>';
        } else {
            featuredPlaces.forEach(place => {
                const card = document.createElement('div');
                card.className = 'featured-card';
                card.onclick = () => showPlaceDetail(place.id);
                card.innerHTML = `
                        ${place.image ? `<img src="${place.image}" alt="${place.name}">` : '<div style="height: 200px; background: #f1f3f4; border-radius: 10px; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem; color: #666;">üì∑ Ch∆∞a c√≥ ·∫£nh</div>'}
                        <h3>${place.name}</h3>
                        <p>${place.category} ‚Ä¢ ${place.address}</p>
                    `;
                featuredPlacesContainer.appendChild(card);
            });
        }

        // Featured dishes
        const allDishes = places.flatMap(place =>
            (place.menu || []).map(dish => ({...dish, placeName: place.name}))
        ).slice(0, 6);

        const featuredDishesContainer = document.getElementById('featuredDishes');
        featuredDishesContainer.innerHTML = '';

        if (allDishes.length === 0) {
            featuredDishesContainer.innerHTML = '<p style="text-align: center; color: #666; grid-column: 1/-1;">Ch∆∞a c√≥ m√≥n ƒÉn n√†o. H√£y th√™m th·ª±c ƒë∆°n cho c√°c ƒë·ªãa ƒëi·ªÉm!</p>';
        } else {
            allDishes.forEach(dish => {
                const card = document.createElement('div');
                card.className = 'featured-card';
                card.innerHTML = `
                        <div style="height: 200px; background: linear-gradient(45deg, #667eea, #764ba2); border-radius: 10px; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem; color: white; font-size: 3rem;">üçΩÔ∏è</div>
                        <h3>${dish.name}</h3>
                        <p><strong>${dish.placeName}</strong> ‚Ä¢ ${dish.price ? dish.price.toLocaleString() + ' VNƒê' : 'Gi√° ch∆∞a c√≥'}</p>
                    `;
                featuredDishesContainer.appendChild(card);
            });
        }
    }

    function previewImage(input, previewId) {
        const file = input.files[0];
        const preview = document.getElementById(previewId);

        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                preview.src = e.target.result;
                preview.style.display = 'block';
            };
            reader.readAsDataURL(file);
        }
    }

    // Export/Import functions
    function exportData() {
        const data = {
            places: places,
            exportDate: new Date().toISOString(),
            version: '1.0'
        };

        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);

        const a = document.createElement('a');
        a.href = url;
        a.download = `food-places-${new Date().toISOString().split('T')[0]}.json`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }

    // Sample data for demonstration
    if (places.length === 0) {
        places = [
            {
                id: 1,
                name: "Ph·ªü H√† N·ªôi",
                category: "Nh√† h√†ng",
                address: "123 Nguy·ªÖn Hu·ªá, Q1",
                phone: "0901234567",
                bookingLink: "",
                notes: "Ph·ªü ngon, n∆∞·ªõc d√πng ƒë·∫≠m ƒë√†",
                image: "",
                menu: [
                    {id: 1, name: "Ph·ªü b√≤", price: 45000, description: "Ph·ªü b√≤ truy·ªÅn th·ªëng"},
                    {id: 2, name: "Ph·ªü g√†", price: 40000, description: "Ph·ªü g√† n∆∞·ªõc trong"}
                ],
                dateAdded: "01/01/2024",
                status: "visited",
                favorite: true
            }
        ];
        localStorage.setItem('places', JSON.stringify(places));
    }
</script>
</body>
</html>